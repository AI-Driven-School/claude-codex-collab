# ベンチマーク結果

実測日: 2025年2月2日

## 概要

Claude Code と Codex を同一タスクで比較し、速度・コスト・品質を測定しました。

```
┌─────────────────────────────────────────────────────────────┐
│                     ベンチマーク結果                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   単純タスク     Codex  ████████████████░░░░  速い・安い    │
│                  Claude ████████████████████  遅い・高い    │
│                                                             │
│   複雑タスク     Codex  ████████████████████████  遅い      │
│                  Claude ████████████████░░░░░░░░  速い      │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## テスト環境

| 項目 | 値 |
|------|-----|
| マシン | MacBook Pro (Apple Silicon) |
| Claude Code | claude-code (Sonnet) |
| Codex | codex-cli 0.93.0 (gpt-5.2-codex) |
| テスト対象 | StressAIAgent (15,588行) |

---

## 単純タスク

### タスク1: カウンターコンポーネント

```
要件: React + TypeScript でカウンターを作成
      - +1, -1, リセットボタン
      - useState使用
      - Tailwind CSSでスタイリング
```

| AI | 実行時間 | コスト | 生成ファイル |
|----|---------|--------|-------------|
| **Codex** | **21.8秒** | $0 | 1ファイル (39行) |
| Claude | 24.8秒 | ~$0.02 | 1ファイル (33行) |

```
速度比較 (秒)
┌────────────────────────────────────────┐
│ Codex  ██████████████████████ 21.8    │
│ Claude █████████████████████████ 24.8  │
└────────────────────────────────────────┘
            Codex 12% 速い
```

---

### タスク2: 認証API

```
要件: FastAPI で JWT 認証 API を実装
      - POST /auth/login（JWT発行）
      - POST /auth/refresh（トークン更新）
      - bcryptでパスワードハッシュ化
```

| AI | 実行時間 | コスト | 生成ファイル |
|----|---------|--------|-------------|
| **Codex** | **46.7秒** | $0 | 1ファイル (auth.py) |
| Claude | 55.7秒 | ~$0.12 | 7ファイル (フルプロジェクト) |

```
速度比較 (秒)
┌────────────────────────────────────────┐
│ Codex  ████████████████████████ 46.7   │
│ Claude ████████████████████████████ 55.7│
└────────────────────────────────────────┘
            Codex 16% 速い
```

**注意**: Claudeは「余計なファイル」も生成（main.py, config.py, models/等）

---

### タスク3: 設計+実装（認証機能フル）

```
要件: 認証機能を設計から実装まで一貫して行う
      - 要件定義書 (docs/requirements.md)
      - OpenAPI仕様 (docs/api.yaml)
      - ログインページ (app/login/page.tsx)
      - APIエンドポイント (app/api/auth/login/route.ts)
      - 認証ユーティリティ (lib/auth.ts)
```

| AI | 実行時間 | トークン | 生成ファイル |
|----|---------|---------|-------------|
| **Codex** | **2分10秒** | 23,478 | 5ファイル |
| Claude | (未測定) | - | - |

**Codex単体で設計→実装が可能**であることを確認。

---

## 複雑タスク

### タスク4: 既存コードベースへの機能追加

```
要件: 15,588行のプロジェクトに Discord 連携を追加
      - 既存のLINE/Slack連携パターンを参考
      - discord_service.py（通知サービス）
      - discord_webhook.py（Webhookエンドポイント）
      - main.pyへのルーター登録
```

| AI | 実行時間 | トークン | 生成コード量 |
|----|---------|---------|-------------|
| Codex | 5分3秒 | 85,424 | 16KB (2ファイル) |
| **Claude** | **3分0秒** | ~50,000 | **34KB (2ファイル)** |

```
速度比較 (秒)
┌────────────────────────────────────────────────────┐
│ Codex  ████████████████████████████████████ 303    │
│ Claude ██████████████████████ 180                   │
└────────────────────────────────────────────────────┘
              Claude 40% 速い
```

```
生成コード量 (KB)
┌────────────────────────────────────────────────────┐
│ Codex  ████████████████ 16KB                       │
│ Claude ████████████████████████████████ 34KB       │
└────────────────────────────────────────────────────┘
              Claude 2倍のコード量
```

### 品質比較（Discord連携）

| 機能 | Codex | Claude |
|------|:-----:|:------:|
| 署名検証 (Ed25519) | ✅ | ✅ |
| メッセージ送信 | ✅ | ✅ |
| Embed対応 | ✅ | ✅ |
| DM送信 | ❌ | ✅ |
| スラッシュコマンド | 簡易 | **複数対応** |
| ボタンアクション | ❌ | ✅ |
| 管理者API | 1個 | **3個** |
| エラーハンドリング | 基本 | **詳細** |

**結論**: 複雑タスクではClaudeが速く、品質も高い

---

## コスト比較

### 単純タスク（3タスク合計）

| 方式 | コスト計算 | 合計 |
|------|-----------|------|
| Claude単体 | $0.02 + $0.12 + $0.15 | **$0.29** |
| Codex単体 | $0 + $0 + $0 | **$0** |
| 3AI連携 | 設計$0.05 + 実装$0 | **$0.05** |

```
コスト比較
┌────────────────────────────────────────────────────┐
│ Claude単体  ████████████████████████████ $0.29    │
│ 3AI連携     ████ $0.05                             │
│ Codex単体   ░ $0                                   │
└────────────────────────────────────────────────────┘
```

### 複雑タスク

| 方式 | 時間 | コスト | 品質 |
|------|------|--------|------|
| Codex単体 | 5分3秒 | $0 | 基本 |
| **Claude単体** | **3分0秒** | ~$0.75 | **高** |

---

## 使い分けガイド

### タスク別推奨AI

```
┌─────────────────────────────────────────────────────────────┐
│                                                             │
│   タスク種別              推奨AI        理由                │
│   ─────────────────────────────────────────────────────    │
│   新規ファイル作成        Codex         速い・$0           │
│   単純なCRUD              Codex         速い・$0           │
│   テスト生成              Codex         速い・$0           │
│   ─────────────────────────────────────────────────────    │
│   既存コード修正          Claude        理解力・品質       │
│   複雑なリファクタリング  Claude        推論力             │
│   アーキテクチャ設計      Claude        設計判断           │
│   ─────────────────────────────────────────────────────    │
│   大規模コード解析        Gemini        1Mトークン・無料   │
│   技術リサーチ            Gemini        無料               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### 判断フローチャート

```
タスクを受け取った
      │
      ▼
  ┌──────────────────┐
  │ 既存コードの理解  │──Yes──▶ Claude
  │ が必要？         │
  └──────────────────┘
      │No
      ▼
  ┌──────────────────┐
  │ 複数ファイルに   │──Yes──▶ Claude
  │ またがる変更？   │
  └──────────────────┘
      │No
      ▼
  ┌──────────────────┐
  │ 10万行超の      │──Yes──▶ Gemini
  │ コード解析？     │
  └──────────────────┘
      │No
      ▼
    Codex（速い・$0）
```

---

## 結論

### 単純タスク

| 勝者 | 理由 |
|------|------|
| **Codex** | 10-20%速い、コスト$0 |

### 複雑タスク

| 勝者 | 理由 |
|------|------|
| **Claude** | 40%速い、2倍のコード量、高品質 |

### 3AI連携の価値

```
✅ 価値がある場面:
   - ChatGPT Pro加入者が単純タスクをCodexに委譲
   - 大規模コードベースの解析をGeminiで実施
   - 複雑な設計判断はClaudeが担当

❌ 価値が薄い場面:
   - 単純タスクのみのプロジェクト（Codex単体で十分）
   - 小規模コードベース（Geminiの1Mトークン不要）
```

---

## 大規模解析タスク（3AI比較）

### タスク5: プロジェクト全体解析レポート

```
要件: 15,588行のプロジェクトを解析しレポート作成
      1. アーキテクチャ概要
      2. 主要機能一覧
      3. 外部連携の実装パターン
      4. セキュリティ懸念点
      5. 改善提案（3つ）
```

### 実行時間

```
実行時間 (分:秒)
┌────────────────────────────────────────────────────────────┐
│ Claude  ██████████████ 3:06                                │
│ Codex   ████████████████████████ 5:31                      │
│ Gemini  ██████████████████████████████ 6:58                │
└────────────────────────────────────────────────────────────┘
```

| AI | 実行時間 | トークン | コスト |
|----|---------|---------|--------|
| **Claude** | **3分6秒** | ~50K | ~$0.75 |
| Codex | 5分31秒 | 145K | $0 |
| Gemini | 6分58秒 | - | **$0（無料）** |

### 品質比較

| 項目 | Claude | Codex | Gemini |
|------|:------:|:-----:|:------:|
| アーキテクチャ図 | ✅ ASCII図 | テキスト | テキスト |
| セキュリティ懸念 | **10項目** | **9項目** | 4項目 |
| 重要度分類 | ✅ High/Med/Low | ✅ 重要度順 | ❌ なし |
| 改善提案コード例 | ✅ | ✅ | ✅ |
| ファイル参照 | ✅ 行番号付き | ✅ パス付き | △ 概要 |

### 使い分け

```
┌─────────────────────────────────────────────────────────────┐
│                    大規模解析タスク                          │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│   速度＋品質優先   → Claude （3分、最も詳細）               │
│   コスト優先       → Gemini （無料、7分、十分な品質）       │
│   バランス         → Codex  （$0、5.5分、詳細）             │
│                                                             │
│   ※ 100万行超のコードベース → Gemini一択（1Mトークン）     │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

---

## 総合結論

### タスク別最適AI

| タスク種別 | 最適AI | 理由 |
|-----------|--------|------|
| 新規ファイル作成（単純） | **Codex** | 10-20%速い、$0 |
| 既存コード修正（複雑） | **Claude** | 40%速い、2倍の品質 |
| 大規模解析（〜10万行） | **Claude** | 最速、最も詳細 |
| 超大規模解析（10万行〜） | **Gemini** | 1Mトークン対応、無料 |
| コスト最優先 | **Codex/Gemini** | どちらも$0 |

### 3AI連携の価値

```
ChatGPT Pro加入者にとって:

単純タスク → Codex（$0）で済ませる
複雑タスク → Claudeの推論力を活用
超大規模解析 → Gemini（無料）で対応

= Claudeの課金を最小化しつつ、品質を維持
```

---

## 再現方法

```bash
cd benchmarks

# 単純タスク
./run-benchmark.sh claude
./run-benchmark.sh codex

# 複雑タスク
cd complex-test
codex exec "..." --full-auto
claude -p --dangerously-skip-permissions "..."
```

詳細は [benchmarks/README.md](./README.md) を参照。
